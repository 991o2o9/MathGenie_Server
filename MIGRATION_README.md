# Миграция для просмотра паролей пользователей

## Описание изменений

Добавлена возможность для администратора просматривать исходные пароли пользователей в админ панели. Это необходимо, поскольку на сайте нет регистрации и только админ может создавать пользователей и выдавать им учетные данные.

## Изменения в коде

### 1. Модель пользователя (`src/models/user.model.js`)

- Добавлено поле `plainPassword` для хранения исходного пароля
- Поле `password` остается для хранения хешированного пароля

### 2. Конфигурация AdminJS (`src/config/adminjs.js`)

- Обновлена конфигурация для отображения поля `plainPassword` в списке и детальном просмотре
- Поле `password` скрыто во всех представлениях
- Добавлена логика для автоматического хеширования паролей при создании/редактировании

### 3. Контроллер пользователей (`src/controllers/user.controller.js`)

- Обновлен для работы с полем `plainPassword`
- API теперь возвращает исходные пароли для администраторов

### 4. Скрипт миграции (`src/utils/migrateUsers.js`)

- Создан для добавления поля `plainPassword` к существующим пользователям
- Устанавливает временные пароли для существующих пользователей

## Инструкции по миграции

### 1. Запуск миграции

```bash
npm run migrate
```

### 2. Проверка результатов

После миграции:

- Все существующие пользователи получат временные пароли в формате `temp_password_XXXXXX`
- Администратор сможет просматривать и изменять пароли через админ панель
- Новые пользователи будут создаваться с отображением исходного пароля

### 3. Обновление паролей существующих пользователей

После миграции администратор должен:

1. Войти в админ панель
2. Перейти к разделу "Users"
3. Для каждого пользователя установить новый пароль в поле "Plain Password"
4. Сохранить изменения

## Безопасность

⚠️ **Важно**: Хранение исходных паролей в базе данных снижает безопасность. Рекомендуется:

1. Ограничить доступ к админ панели только доверенным администраторам
2. Использовать HTTPS для всех соединений
3. Регулярно менять пароли пользователей
4. Рассмотреть возможность отправки паролей пользователям по email вместо хранения в базе

## Использование

### В админ панели:

- **Список пользователей**: Отображается колонка "Plain Password" с исходными паролями
- **Детальный просмотр**: Показывается поле "Plain Password"
- **Создание/редактирование**: Можно ввести новый пароль в поле "Plain Password"

### В API:

- Все эндпоинты для работы с пользователями теперь возвращают поле `plainPassword`
- Аутентификация по-прежнему работает с хешированными паролями

## Откат изменений

Если необходимо откатить изменения:

1. Удалить поле `plainPassword` из модели пользователя
2. Обновить конфигурацию AdminJS
3. Обновить контроллеры
4. Удалить скрипт миграции

```bash
# Удалить скрипт миграции
rm src/utils/migrateUsers.js
```
